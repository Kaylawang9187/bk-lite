[[inputs.snmp]]
    interval = "{{ interval }}s"
    {% if version == 2 %}
    agents = ["udp://{{ snmp_config.ip }}:{{ snmp_config.port }}"]
    version = 2
    community = "{{ snmp_config.community }}"
    timeout = {{ snmp_config.timeout }}
    {% elif version == 3 %}
    agents = ["udp://{{ snmp_config.ip }}:{{ snmp_config.port }}"]
    version = 3
    timeout = {{ snmp_config.timeout }}
    sec_name = "{{ snmp_config.sec_name }}"
    sec_level = "{{ snmp_config.sec_level }}"
    auth_protocol = "{{ snmp_config.auth_protocol }}"
    auth_password = "{{ snmp_config.auth_password }}"
    priv_protocol = "{{ snmp_config.priv_protocol }}"
    priv_password = "{{ snmp_config.priv_password }}"
    {% else %}
    {% endif %}
    [inputs.snmp.tags]
        instance_id = "{{ instance_id }}"
        instance_type = "{{ instance_type }}"
        collect_type = "snmp"
        config_type = "bastion_host"
    [[inputs.snmp.field]]
        oid = "RFC1213-MIB::sysUpTime.0"
        name = "uptime"
    [[inputs.snmp.field]]
        oid = "RFC1213-MIB::sysName.0"
        name = "source"
        is_tag = true
    [[inputs.snmp.table]]
        oid = "IF-MIB::ifTable"
        name = "interface"
        inherit_tags = ["source"]
    [[inputs.snmp.table.field]]
        oid = "IF-MIB::ifDescr"
        name = "ifDescr"
        is_tag = true